<div id="app">
  <h2>新增訂單</h2>
  <input type="text" id="custName" placeholder="客人名稱">
  <select id="source">
    <option>IG</option><option>WhatsApp</option><option>Threads</option>
  </select>

  <div id="itemsContainer">
    <div class="item-row">
      <input type="text" class="prodName" placeholder="商品名稱">
      <input type="number" class="amount" placeholder="金額">
    </div>
  </div>
  
  <button onclick="addItem()">+ 加一件商品</button>
  <button onclick="submitOrder()">送出訂單</button>
</div>

<script>
  // 1. 動態加一行
  function addItem() {
    const container = document.getElementById('itemsContainer');
    const newRow = document.createElement('div');
    newRow.className = 'item-row';
    newRow.innerHTML = `
      <input type="text" class="prodName" placeholder="商品名稱">
      <input type="number" class="amount" placeholder="金額">
    `;
    container.appendChild(newRow);
  }

  // 2. 送出資料去 Google Apps Script
  async function submitOrder() {
    const rows = document.querySelectorAll('.item-row');
    const items = Array.from(rows).map(row => ({
      productName: row.querySelector('.prodName').value,
      amount: row.querySelector('.amount').value
    }));

    const payload = {
      customerName: document.getElementById('custName').value,
      source: document.getElementById('source').value,
      items: items,
      orderID: "ORD" + Date.now()
    };

    // 換成你 GAS 部署後嘅 Web App URL
    const GAS_URL = "AKfycby5vPRE71thYhYY-4XDMZ2oByLBsaZmy_FQPHzjHvAthhCTFmUCC29SycppE4d7pJ4mWA";
    
    await fetch(GAS_URL, {
      method: "POST",
      body: JSON.stringify(payload)
    });
    alert("成功！");
  }
</script>
